<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>Pusat Game Offline</title>
    <style>
        /* [SEMUA CSS SEBELUMNYA TETAP] */
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; }
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden; background: #0f172a; font-family: 'Segoe UI', sans-serif; color: #fff; padding-top: env(safe-area-inset-top); }
        #main-container { width: 100%; height: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        h1 { font-size: 24px; color: #38bdf8; margin: 0 0 10px 0; }
        .menu-selection { margin-bottom: 15px; display: flex; gap: 10px; }
        select { padding: 8px; border-radius: 5px; background: #1e293b; color: white; border: 1px solid #38bdf8; cursor: pointer; }
        #game-menu { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; padding: 20px; }
        .menu-card { background: #1e293b; padding: 20px; border-radius: 15px; text-align: center; cursor: pointer; border: 2px solid transparent; transition: 0.3s; }
        .menu-card:active { border-color: #38bdf8; transform: scale(0.95); }
        .menu-card span { font-size: 40px; display: block; margin-bottom: 10px; }
        .game-screen { display: none; flex-direction: column; align-items: center; width: 100%; height: 100%; justify-content: center; overflow-y: auto; padding: 20px 0; }
        .active { display: flex; }
        .board { display: grid; grid-template-columns: repeat(3, 85px); grid-template-rows: repeat(3, 85px); gap: 10px; background: #1e293b; padding: 15px; border-radius: 15px; position: relative; }
        .cell { background: #334155; border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 35px; font-weight: bold; }
        #winning-line { position: absolute; background: #f43f5e; display: none; z-index: 10; border-radius: 10px; }
        canvas { background: #1e293b; border-radius: 15px; border: 2px solid #334155; max-width: 90vw; max-height: 45vh; }
        .snake-controls { display: grid; grid-template-columns: repeat(3, 60px); grid-template-rows: repeat(2, 60px); gap: 10px; margin-top: 15px; }
        .ctrl-btn { background: #334155; border: 2px solid #38bdf8; color: white; border-radius: 12px; font-size: 24px; display: flex; align-items: center; justify-content: center; }
        .math-box { background: #1e293b; padding: 30px; border-radius: 15px; text-align: center; border: 2px solid #38bdf8; width: 80%; max-width: 300px; }
        #math-q { font-size: 40px; margin-bottom: 20px; }
        #math-ans { width: 100%; padding: 10px; font-size: 24px; border-radius: 8px; border: none; text-align: center; background: #334155; color: white; }
        #math-lives, #mole-lives { color: #fb7185; font-weight: bold; font-size: 18px; margin-bottom: 10px; }
        .status { margin-top: 10px; font-size: 16px; color: #94a3b8; height: 20px; }
        .btn-group { margin-top: 15px; display: flex; gap: 10px; flex-wrap: wrap; justify-content: center; }
        button { padding: 10px 15px; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; }
        .btn-back { background: #ef4444; color: white; width: 200px; margin-top: 10px; }
        .btn-reset { background: #334155; color: white; }
        .btn-start { background: #10b981; color: white; font-size: 18px; padding: 15px 30px; }
    </style>
</head>
<body>

    <div id="main-container">
        <div id="game-menu" class="active game-screen" style="display: grid;">
            <h1 style="grid-column: span 2; text-align: center;">OFFLINE GAMES</h1>
            <div class="menu-card" onclick="showGame('ttt')"><span>‚ùå‚≠ï</span>Tic Tac Toe</div>
            <div class="menu-card" onclick="showGame('snake')"><span>üêç</span>Snake</div>
            <div class="menu-card" onclick="showGame('math')"><span>‚ûï</span>Math Quiz</div>
            <div class="menu-card" onclick="showGame('mole')"><span>üî®</span>Whack Mole</div>
            <button class="btn-reset" style="grid-column: span 2; margin-top: 10px;" onclick="window.location.reload()">Cek Koneksi</button>
        </div>

        <div id="screen-ttt" class="game-screen">
            <h1>TIC TAC TOE</h1>
            <div class="menu-selection">
                <label>Level: </label>
                <select id="difficulty" onchange="resetGame()">
                    <option value="easy">Mudah</option><option value="medium">Sedang</option><option value="hard">Sulit</option><option value="impossible">Mustahil</option>
                </select>
            </div>
            <div class="board" id="board">
                <div id="winning-line"></div>
                <div class="cell" onclick="makeMove(0)"></div><div class="cell" onclick="makeMove(1)"></div><div class="cell" onclick="makeMove(2)"></div>
                <div class="cell" onclick="makeMove(3)"></div><div class="cell" onclick="makeMove(4)"></div><div class="cell" onclick="makeMove(5)"></div>
                <div class="cell" onclick="makeMove(6)"></div><div class="cell" onclick="makeMove(7)"></div><div class="cell" onclick="makeMove(8)"></div>
            </div>
            <div class="status" id="status">Giliran Kamu</div>
            <div class="btn-group"><button class="btn-reset" onclick="resetGame()">Ulang</button><button class="btn-back" onclick="goToMenu()">Menu Utama</button></div>
        </div>

        <div id="screen-snake" class="game-screen">
            <h1>SNAKE</h1>
            <div class="menu-selection">
                <label>Kecepatan: </label>
                <select id="snake-level" onchange="initSnake()"><option value="200">Santai</option><option value="150" selected>Normal</option><option value="80">Cepat</option></select>
            </div>
            <canvas id="snakeCanvas" width="400" height="400"></canvas>
            <div id="snake-controls-ui" class="snake-controls" style="display: none;">
                <div class="ctrl-btn up" onclick="changeSnakeDir('UP')">‚ñ≤</div>
                <div class="ctrl-btn left" onclick="changeSnakeDir('LEFT')">‚óÄ</div>
                <div class="ctrl-btn down" onclick="changeSnakeDir('DOWN')">‚ñº</div>
                <div class="ctrl-btn right" onclick="changeSnakeDir('RIGHT')">‚ñ∂</div>
            </div>
            <div style="margin-top: 15px;"><button id="btn-start-snake" class="btn-start" onclick="startSnakeLoop()">MULAI GAME</button></div>
            <div class="status" id="snake-status">Skor: 0</div>
            <button class="btn-back" onclick="goToMenu()">Menu Utama</button>
        </div>

        <div id="screen-math" class="game-screen">
            <h1>MATH QUIZ</h1>
            <div id="math-lives">‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è</div>
            <div class="math-box"><div id="math-q">? + ?</div><input type="number" id="math-ans"></div>
            <div class="status" id="math-status">Skor: 0</div>
            <button class="btn-back" onclick="goToMenu()">Menu Utama</button>
        </div>

        <div id="screen-mole" class="game-screen">
            <h1>WHACK A MOLE</h1>
            <div class="menu-selection">
                <label>Level: </label>
                <select id="mole-level" onchange="initMole()">
                    <option value="1200">Mudah</option>
                    <option value="800" selected>Sedang</option>
                    <option value="500">Sulit</option>
                </select>
            </div>
            <div id="mole-lives">‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è</div>
            <canvas id="moleCanvas" width="300" height="300"></canvas>
            <div class="status" id="mole-status">Skor: 0</div>
            <button class="btn-back" onclick="goToMenu()">Menu Utama</button>
        </div>
    </div>

    <script>
        // [LOGIKA NAVIGASI, TTT, SNAKE, MATH TETAP SEPERTI SEBELUMNYA]
        function showGame(id) {
            document.querySelectorAll('.game-screen').forEach(s => { s.classList.remove('active'); s.style.display = 'none'; });
            const target = document.getElementById('screen-' + id);
            target.classList.add('active'); target.style.display = 'flex';
            document.getElementById('game-menu').style.display = 'none';
            if(id === 'snake') initSnake();
            if(id === 'math') resetMath();
            if(id === 'mole') initMole();
        }
        function goToMenu() { location.reload(); }

        /* --- LOGIKA TIC TAC TOE & SNAKE & MATH (DILEWATI KARENA TIDAK BERUBAH) --- */
        // ... (Kode TTT, Snake, dan Math tetap ada di sini) ...

        /* --- 4. LOGIKA WHACK A MOLE (UPDATE: RABBIT & CARROT) --- */
        let moleData = []; // Menyimpan apa yang ada di setiap lubang
        let moleScore, moleLives, moleLoop;

        function initMole() {
            clearInterval(moleLoop);
            moleScore = 0;
            moleLives = 5;
            document.getElementById('mole-status').innerText = "Skor: 0";
            updateMoleLives();
            
            const canvas = document.getElementById('moleCanvas');
            const ctx = canvas.getContext('2d');
            const difficulty = document.getElementById('mole-level').value;
            
            // Logika Klik
            canvas.onclick = (e) => {
                const rect = canvas.getBoundingClientRect();
                const x = (e.clientX - rect.left) * (canvas.width / rect.width);
                const y = (e.clientY - rect.top) * (canvas.height / rect.height);
                const col = Math.floor(x/100); const row = Math.floor(y/100);
                const idx = row*3 + col;
                
                if(moleData[idx] === "RABBIT") {
                    moleScore++;
                    document.getElementById('mole-status').innerText = "Skor: " + moleScore;
                    moleData[idx] = null; // Hilangkan setelah dipukul
                    drawMoleGrid(ctx);
                } else if(moleData[idx] === "CARROT") {
                    moleLives = 0; // Langsung kalah (dikurangi 5 nyawa)
                    updateMoleLives();
                    gameOverMole();
                }
            };

            moleLoop = setInterval(() => {
                generateObjects();
                drawMoleGrid(ctx);
            }, difficulty);
        }

        function updateMoleLives() {
            let hearts = "";
            for(let i=0; i<moleLives; i++) hearts += "‚ù§Ô∏è";
            document.getElementById('mole-lives').innerText = hearts || "GAME OVER";
        }

        function generateObjects() {
            moleData = new Array(9).fill(null);
            const level = document.getElementById('mole-level').value;
            
            // Tentukan jumlah wortel berdasarkan level
            let carrotCount = 1;
            if(level == "800") carrotCount = 2; // Sedang
            if(level == "500") carrotCount = 4; // Sulit

            // Munculkan Kelinci (Selalu 1)
            let rabbitIdx = Math.floor(Math.random()*9);
            moleData[rabbitIdx] = "RABBIT";

            // Munculkan Wortel
            let placedCarrots = 0;
            while(placedCarrots < carrotCount) {
                let r = Math.floor(Math.random()*9);
                if(moleData[r] === null) {
                    moleData[r] = "CARROT";
                    placedCarrots++;
                }
            }
        }

        function drawMoleGrid(ctx) {
            ctx.fillStyle = "#1e293b"; ctx.fillRect(0,0,300,300);
            ctx.font = "50px Arial";
            for(let i=0; i<9; i++) {
                ctx.strokeStyle = "#334155";
                ctx.strokeRect((i%3)*100, Math.floor(i/3)*100, 100, 100);
                if(moleData[i] === "RABBIT") {
                    ctx.fillText("üê∞", (i%3)*100+25, Math.floor(i/3)*100+70);
                } else if(moleData[i] === "CARROT") {
                    ctx.fillText("ü•ï", (i%3)*100+25, Math.floor(i/3)*100+70);
                }
            }
        }

        function gameOverMole() {
            clearInterval(moleLoop);
            setTimeout(() => {
                alert("Game Over! Kamu memukul Wortel!\nSkor Akhir: " + moleScore);
                initMole();
            }, 100);
        }

        /* --- [LANJUTAN KODE MATH, SNAKE, TTT SEBELUMNYA DI SINI] --- */
        // Pastikan fungsi-fungsi math dan snake dari chat sebelumnya tetap ada di bawah sini.
    </script>
</body>
</html>
